
# ğŸ“Œ Function Calling ê°œë…

ëª¨ë¸ì´ ì‘ë‹µìœ¼ë¡œ ìì—°ì–´ í…ìŠ¤íŠ¸ ëŒ€ì‹ , ë¯¸ë¦¬ ì •ì˜ëœ í•¨ìˆ˜ì˜ ì´ë¦„ê³¼ ì¸ì(JSON í˜•íƒœ)ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

![Function Calling](images/function_calling.png)

ì™œ í•„ìš”í• ê¹Œ?
ëª¨ë¸ì´ â€œê²€ìƒ‰í•´ì¤˜, ê³„ì‚°í•´ì¤˜, ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ êº¼ë‚´ì¤˜â€ ê°™ì€ ìš”ì²­ì„ ë°›ì•˜ì„ ë•Œ, ê·¸ëƒ¥ í…ìŠ¤íŠ¸ ì„¤ëª…ë§Œ í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼ ê°œë°œìê°€ ì—°ê²°í•´ë‘” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ ì‹¤ì œ ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.

## ğŸ“Œ ì˜ˆì œ ì‹œë‚˜ë¦¬ì˜¤

ì‚¬ìš©ìê°€ "ì„œìš¸ ë‚ ì”¨ ì•Œë ¤ì¤˜"ë¼ê³  ë¬¼ì–´ë³´ë©´ â†’ ëª¨ë¸ì´ `get_weather` í•¨ìˆ˜ë¥¼ í˜¸ì¶œ â†’ ì‹¤ì œ í•¨ìˆ˜ê°€ ì‹¤í–‰ â†’ ê²°ê³¼ë¥¼ ëª¨ë¸ì´ ìì—°ìŠ¤ëŸ½ê²Œ ì‘ë‹µ.

## ğŸ“Œ ì½”ë“œ ì˜ˆì œ (Python)

```python
import os
from openai import AzureOpenAI

client = AzureOpenAI(
    api_version="2024-12-01-preview",
    azure_endpoint="https://labuser111-openai.openai.azure.com/",
    api_key=subscription_key,
)

# í•¨ìˆ˜ ì •ì˜ (JSON Schema ë°©ì‹)
functions = [
    {
        "name": "get_weather",
        "description": "Get the current weather in a given city",
        "parameters": {
            "type": "object",
            "properties": {
                "location": {
                    "type": "string",
                    "description": "The city and country, e.g. Seoul, South Korea"
                }
            },
            "required": ["location"]
        }
    }
]

# ì‹¤ì œ í•¨ìˆ˜ (ëª¨ë¸ì€ ì´ê±¸ ì§ì ‘ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ, ìš°ë¦¬ê°€ ì‹¤í–‰)
def get_weather(location: str):
    # ì‹¤ì œë¡œëŠ” ì™¸ë¶€ API í˜¸ì¶œ (ì˜ˆ: OpenWeather API) ë„£ìœ¼ë©´ ë¨
    # ì—¬ê¸°ì„œëŠ” ìƒ˜í”Œ ë°ì´í„° ë¦¬í„´
    return {"location": location, "temperature": "28Â°C", "condition": "Sunny"}

# Step 1. ëª¨ë¸ì— ì‚¬ìš©ì ì§ˆë¬¸ ì „ë‹¬
response = client.chat.completions.create(
    model="dev-gpt-4.1-mini",  # function calling ì§€ì› ëª¨ë¸
    messages=[{"role": "user", "content": "ì„œìš¸ ë‚ ì”¨ ì•Œë ¤ì¤˜"}],
    functions=functions,
    function_call="auto",  # ëª¨ë¸ì´ í•„ìš” ì‹œ í•¨ìˆ˜ í˜¸ì¶œ
)

# Step 2. ëª¨ë¸ì˜ ì‘ë‹µ í™•ì¸
msg = response.choices[0].message

if msg.function_call:  # í•¨ìˆ˜ í˜¸ì¶œ ìš”ì²­ì´ ìˆìœ¼ë©´
    func_name = msg.function_call.name
    args = msg.function_call.arguments

    if func_name == "get_weather":
        # ì‹¤ì œ í•¨ìˆ˜ ì‹¤í–‰
        import json
        args_dict = json.loads(args)
        result = get_weather(**args_dict)

        # Step 3. í•¨ìˆ˜ ê²°ê³¼ë¥¼ ë‹¤ì‹œ ëª¨ë¸ì— ì „ë‹¬
        second_response = client.chat.completions.create(
            model="dev-gpt-4.1-mini",
            messages=[
                {"role": "user", "content": "ì„œìš¸ ë‚ ì”¨ ì•Œë ¤ì¤˜"},
                msg,  # ëª¨ë¸ì´ ë³´ë‚¸ function_call
                {"role": "function", "name": func_name, "content": str(result)},
            ],
        )

        print(second_response.choices[0].message.content)
```

## ğŸ“Œ ì‹¤í–‰ íë¦„

1. ì‚¬ìš©ìê°€ `"ì„œìš¸ ë‚ ì”¨ ì•Œë ¤ì¤˜"` â†’ ëª¨ë¸ì´ `"get_weather"` í•¨ìˆ˜ í˜¸ì¶œì„ ì œì•ˆ
2. Python ì½”ë“œì—ì„œ ì‹¤ì œ `get_weather()` í•¨ìˆ˜ ì‹¤í–‰
3. ê²°ê³¼ë¥¼ ëª¨ë¸ì— ë‹¤ì‹œ ì „ë‹¬
4. ëª¨ë¸ì´ ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆê²Œ ì‘ë‹µ ì •ë¦¬ â†’ `"í˜„ì¬ ì„œìš¸ì˜ ë‚ ì”¨ëŠ” ë§‘ê³ , 28ë„ì…ë‹ˆë‹¤."`

ì¦‰, ëª¨ë¸ì€ **â€œë¬´ìŠ¨ í•¨ìˆ˜ë¥¼ ì–´ë–»ê²Œ ë¶ˆëŸ¬ì•¼ í•˜ëŠ”ì§€â€ë§Œ ì•Œë ¤ì£¼ê³ **,
**ì‹¤ì œ ì‹¤í–‰ì€ ê°œë°œìê°€ ì»¨íŠ¸ë¡¤**í•˜ëŠ” ë°©ì‹ì´ì—ìš”. ğŸ”‘
